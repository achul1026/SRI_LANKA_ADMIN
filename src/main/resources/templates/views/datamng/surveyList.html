<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layout/layout}">

<th:block layout:fragment="content">
	<div class="is-box">
		<form id="searchForm" name="searchForm" th:action="@{/datamng/survey}">
			<input type="hidden" id="pageNo" name="pageNo" value="1">
			<div id="filterWrap">
				<div id="filterTitle">
					<h2 th:text="#{common.search.title}">검색 설정</h2>
				</div>
				<table id="filterTable">
					<colgroup>
						<col width="15%">
						<col width="85%">
					</colgroup>
					<tr>
						<th th:text="#{common.table.investType}">조사 유형</th>
						<td>
							<div class="select-div-box">
								<select class="select-list-box" name="searchTypeCd">
									<option value="" th:text="#{common.table.investType}">조사 유형</option>
									<option th:each="item:${srvyCdList}" th:text="${item.cdNm}" th:value="${item.cd}"
										th:selected="${searchInfo.searchTypeCd eq item.cd}"></option>
								</select>
							</div>
						</td>
					</tr>
					<tr>
						<th th:text="#{common.table.registDate}">조사기간</th>
<!-- 						<td> -->
<!-- 							<select id="startDt" class="dateYear scroll select-list-box"></select> -->
<!-- 							<span>~</span> -->
<!-- 							<select id="endDt" class="dateYear scroll select-list-box"></select> -->
<!-- 						</td> -->
						<td>
							<input type="text" class="input-text startPicker" name="startDate" th:placeholder="#{common.search.placeholder.date}"
								th:value="${searchInfo.startDate}">
							<span>~</span>
							<input type="text" class="input-text endPicker" name="endDate" th:placeholder="#{common.search.placeholder.date}"
								th:value="${searchInfo.endDate}">
						</td>
					</tr>
					<tr>
						<th th:text="#{common.search.detail.content}">상세 내용</th>
						<td>
							<input type="text" class="input-text search-input" name="searchContent"
								th:placeholder="#{common.search.placeholder.investName}" th:value="${searchInfo.searchContent}">
						</td>
					</tr>
				</table>
				<div id="filterBtnWrap">
<!-- 					<input type="button" class="is-sub-button" th:value="#{survey.surveyList.period.reset}" onclick="resetSearchDate()"> -->
					<button type="submit" class="is-key-button" th:text="#{common.button.search}">검색</button>
				</div>
			</div>
		</form>

		<div id="listTableContainer">
			<div class="list-save-box">
				<div id="totalList"><span id="totalCount" th:text="${totalCnt}"></span><span th:text="#{common.search.result}">건의 검색 결과를 찾았습니다.</span></div>
				<div>
					<a href="/datamng/survey/save/select" class="is-key-button" th:text="#{survey.surveyList.button.invest.regist}">설문 등록</a>
				</div>
			</div>
			<table id="listTable" class="cm-list-table">
				<thead>
					<tr>
						<th th:text="#{common.table.number}">번호</th>
						<th th:text="#{common.table.investType}">조사 유형</th>
						<th th:text="#{survey.common.invest.name}">설문 명</th>
						<th th:text="#{common.table.registDate}">조사 기간(년)</th>
						<th th:text="#{common.table.register}">작성자</th>
					</tr>
				</thead>
				<tbody>
					<th:block th:if="${totalCnt > 0}">
						<tr class="table-link" th:each="item,status : ${surveyList}"
							th:onclick="|location.href='@{/datamng/survey/{srvyId}(srvyId=${item.srvyId})}'|">
							<td th:text="${@commonUtils.getRownum(paging,status.index)}"></td>
							<td th:text="${item.srvyTypeNm}"></td>
							<td th:text="${item.srvyTitle}"></td>
							<td	th:text="${@commonUtils.formatLocalDateTime(item.registDt,'yyyy-MM-dd')}">
							</td>
							<td th:text="${item.registId}"></td>
						</tr>
					</th:block>
					<th:block th:if="${totalCnt == 0}">
						<tr>
							<td colspan="5" th:text="#{common.search.result.notExist}">검색 결과가 없습니다.</td>
						</tr>
					</th:block>
				</tbody>
			</table>
		</div>
		<div th:insert="tags/paging/paging :: pagingFragment"></div>
	</div>
</th:block>

</html>
<script th:inline="javascript">
// 	dateYearSet();
	sectTypeCdArray = /*[[${sectTypeCd}]]*/;
// 	let selectStartDt = document.querySelector('#startDt');
// 	let selectEndDt = document.querySelector('#endDt');

// 	function searchSurvey() {
// 		const pageNo = document.getElementById('pageNo').value;
// 		const searchContent = document.getElementById('searchContent').value;
// 		const select = document.getElementById('searchTypeCd');
// 		const option = select.options[select.selectedIndex];
// 		const searchTypeCd = option.value;

// 		const startDate = selectStartDt.options[selectStartDt.selectedIndex].value;
// 		const endDate = selectEndDt.options[selectEndDt.selectedIndex].value;
// 		const params = new URLSearchParams();
// 		if (!!startDate) {
// 			params.append('startDate', startDate + "-01-01");
// 		}
// 		if (!!endDate) {
// 			params.append('endDate', endDate + "-12-31");
// 		}

// 		params.append('pageNo', pageNo);
// 		params.append('searchContent', searchContent);
// 		params.append('searchTypeCd', searchTypeCd);

// 		window.location.href = "/datamng/survey?" + params.toString();

// 	}

	// 검색한날짜 찍어주기
// 	const searchStartDate = /*[[${searchInfo.startDate}]]*/;
// 	const searchEndDate = /*[[${searchInfo.endDate}]]*/;

// 	if (searchStartDate !== null) {
// 		const startSplit = searchStartDate.toString().split('-')[0];
// 		dateSelected('#startDt', startSplit);
// 	}

// 	if (searchEndDate !== null) {
// 		const endSplit = searchEndDate.toString().split('-')[0];
// 		dateSelected('#endDt', endSplit);
// 	}

// 	function dateSelected(element, optionValue) {
// 		const selectName = document.querySelector(`${element}`);
// 		const selectOption = selectName.options.length;

// 		for (let i = 0; i < selectOption; i++) {
// 			if (selectName.options[i].value == optionValue) {
// 				selectName.options[i].selected = true;
// 			}
// 		}
// 	}

// 	// 날짜 초기화
// 	function resetSearchDate() {
// 		let today = new Date();
// 		document.getElementById('startDt').value = '';
// 		document.getElementById('endDt').value = '';
// 	}

</script>